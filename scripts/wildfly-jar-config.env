# üè≠ WildFly Configuration for ARKA JAR Deployment
# Sistema de configuraci√≥n para manejar m√∫ltiples JARs ejecutables como servicios independientes

# ==================================================
# WildFly System Configuration
# ==================================================

# JVM Heap Settings para WildFly Server
WILDFLY_OPTS="-Xms1024m -Xmx2048m -XX:+UseG1GC -XX:MaxGCPauseMillis=200"

# WildFly Standalone Configuration
WILDFLY_CONFIG="standalone-full.xml"

# Network Configuration
WILDFLY_BIND_ADDRESS="0.0.0.0"
WILDFLY_MANAGEMENT_BIND_ADDRESS="127.0.0.1"

# ==================================================
# Service Port Configuration
# ==================================================

# Infrastructure Services
CONFIG_SERVER_PORT=8888
EUREKA_SERVER_PORT=8761

# Gateway Services  
API_GATEWAY_PORT=8085

# Business Services
ARCA_COTIZADOR_PORT=8081
ARCA_GESTOR_SOLICITUDES_PORT=8082
HELLO_WORLD_SERVICE_PORT=8083

# Management Ports (Actuator)
CONFIG_SERVER_MGMT_PORT=9888
EUREKA_SERVER_MGMT_PORT=9761
API_GATEWAY_MGMT_PORT=9085
ARCA_COTIZADOR_MGMT_PORT=9081
ARCA_GESTOR_SOLICITUDES_MGMT_PORT=9082
HELLO_WORLD_SERVICE_MGMT_PORT=9083

# ==================================================
# JVM Configuration por Tipo de Servicio
# ==================================================

# Infrastructure Services JVM Options
INFRA_JVM_OPTS="-Xms512m -Xmx1024m -XX:+UseG1GC -XX:MaxGCPauseMillis=200"

# Gateway Services JVM Options
GATEWAY_JVM_OPTS="-Xms256m -Xmx512m -XX:+UseG1GC -XX:MaxGCPauseMillis=100"

# Business Services JVM Options
BUSINESS_JVM_OPTS="-Xms256m -Xmx512m -XX:+UseG1GC -XX:MaxGCPauseMillis=100"

# ==================================================
# Spring Profile Configuration
# ==================================================

# Default Spring Profiles
DEFAULT_SPRING_PROFILES="aws"

# Config Server Specific
CONFIG_SERVER_PROFILES="native,aws"

# Common Spring Boot Properties
SPRING_BOOT_COMMON_OPTS="
-Dspring.cloud.config.fail-fast=true
-Dspring.cloud.config.retry.max-attempts=3
-Dspring.cloud.config.retry.initial-interval=1000
-Dmanagement.endpoints.web.exposure.include=health,info,metrics,env
-Dmanagement.endpoint.health.show-details=always
-Dlogging.level.com.arkavalenzuela=DEBUG
-Dlogging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} - %msg%n
"

# ==================================================
# Security Configuration
# ==================================================

# JWT Configuration
JWT_SECRET_KEY="arka-valenzuela-jwt-secret-key-2024-production"
JWT_EXPIRATION_TIME="86400000"

# Database Security
DB_ENCRYPTION_KEY="arka-db-encryption-key-2024"

# ==================================================
# AWS Configuration
# ==================================================

# AWS RDS MySQL Configuration
AWS_RDS_ENDPOINT="172.31.48.25"
AWS_RDS_PORT="3306"
AWS_RDS_DATABASE="arka-base"
AWS_RDS_USERNAME="admin"
AWS_RDS_PASSWORD="Temporal123*"

# AWS DocumentDB Configuration  
AWS_DOCDB_ENDPOINT="arka-docdb-cluster.cluster-ch0z9qzpkrpq.us-east-1.docdb.amazonaws.com"
AWS_DOCDB_PORT="27017"
AWS_DOCDB_DATABASE="arka-notifications"
AWS_DOCDB_USERNAME="admin"
AWS_DOCDB_PASSWORD="Temporal123*"

# AWS S3 Configuration
AWS_S3_BUCKET="arka-s3-bucket2"
AWS_REGION="us-east-1"

# ==================================================
# Logging Configuration
# ==================================================

# Log Levels
ROOT_LOG_LEVEL="INFO"
ARKA_LOG_LEVEL="DEBUG"
SPRING_LOG_LEVEL="INFO"

# Log File Configuration
LOG_FILE_MAX_SIZE="50MB"
LOG_FILE_MAX_HISTORY="30"
LOG_FILE_TOTAL_SIZE_CAP="1GB"

# ==================================================
# Health Check Configuration
# ==================================================

# Health Check URLs
HEALTH_CHECK_TIMEOUT=30
HEALTH_CHECK_INTERVAL=10
HEALTH_CHECK_RETRIES=3

# Service Health Check Endpoints
declare -A HEALTH_ENDPOINTS=(
    ["config-server"]="http://localhost:8888/actuator/health"
    ["eureka-server"]="http://localhost:8761/actuator/health"
    ["api-gateway"]="http://localhost:8085/actuator/health"
    ["arca-cotizador"]="http://localhost:8081/actuator/health"
    ["arca-gestor-solicitudes"]="http://localhost:8082/actuator/health"
    ["hello-world-service"]="http://localhost:8083/actuator/health"
)

# ==================================================
# Process Management Configuration
# ==================================================

# PID File Directory
PID_DIR="/opt/arka/pids"

# Log File Directory
LOG_DIR="/opt/arka/logs"

# JAR File Directory
JAR_DIR="/opt/arka/dist/jars"

# Backup Directory
BACKUP_DIR="/opt/arka/backup"

# ==================================================
# Service Startup Order and Dependencies
# ==================================================

# Startup Order (higher number = start first)
declare -A SERVICE_PRIORITY=(
    ["config-server"]="30"
    ["eureka-server"]="20"
    ["api-gateway"]="10"
    ["arca-cotizador"]="5"
    ["arca-gestor-solicitudes"]="5"
    ["hello-world-service"]="5"
)

# Service Dependencies
declare -A SERVICE_DEPENDENCIES=(
    ["eureka-server"]="config-server"
    ["api-gateway"]="config-server,eureka-server"
    ["arca-cotizador"]="config-server,eureka-server"
    ["arca-gestor-solicitudes"]="config-server,eureka-server"
    ["hello-world-service"]="config-server,eureka-server"
)

# ==================================================
# Monitoring Configuration
# ==================================================

# Enable JMX Monitoring
ENABLE_JMX_MONITORING="true"
JMX_PORT_BASE="9999"

# Enable Flight Recorder
ENABLE_FLIGHT_RECORDER="true"

# Enable GC Logging
ENABLE_GC_LOGGING="true"

# ==================================================
# Deployment Configuration
# ==================================================

# Deployment Mode
DEPLOYMENT_MODE="production"

# Enable Blue-Green Deployment
ENABLE_BLUE_GREEN="false"

# Rolling Deployment Settings
ROLLING_DEPLOYMENT_BATCH_SIZE="1"
ROLLING_DEPLOYMENT_DELAY="30"

# ==================================================
# Backup and Recovery Configuration
# ==================================================

# Backup Retention Days
BACKUP_RETENTION_DAYS="7"

# Enable Automatic Backup
ENABLE_AUTO_BACKUP="true"

# Backup Schedule (cron format)
BACKUP_SCHEDULE="0 2 * * *"

# ==================================================
# Performance Tuning
# ==================================================

# Connection Pool Settings
DB_CONNECTION_POOL_MIN_SIZE="5"
DB_CONNECTION_POOL_MAX_SIZE="20"
DB_CONNECTION_POOL_TIMEOUT="30000"

# HTTP Client Settings
HTTP_CLIENT_TIMEOUT="30000"
HTTP_CLIENT_MAX_CONNECTIONS="100"

# ==================================================
# Load Balancer Configuration
# ==================================================

# Load Balancer Health Check Path
LB_HEALTH_CHECK_PATH="/actuator/health"

# Load Balancer Health Check Interval
LB_HEALTH_CHECK_INTERVAL="30"

# Load Balancer Session Affinity
LB_SESSION_AFFINITY="false"

# ==================================================
# Auto-scaling Configuration
# ==================================================

# CPU Threshold for Scaling
CPU_SCALE_UP_THRESHOLD="80"
CPU_SCALE_DOWN_THRESHOLD="20"

# Memory Threshold for Scaling
MEMORY_SCALE_UP_THRESHOLD="85"
MEMORY_SCALE_DOWN_THRESHOLD="30"

# ==================================================
# Alerting Configuration
# ==================================================

# Alert Email Recipients
ALERT_EMAIL_RECIPIENTS="admin@arkavalenzuela.com,ops@arkavalenzuela.com"

# Alert Thresholds
ALERT_CPU_THRESHOLD="90"
ALERT_MEMORY_THRESHOLD="90"
ALERT_DISK_THRESHOLD="85"

# ==================================================
# Development and Testing Configuration
# ==================================================

# Enable Development Mode Features
ENABLE_DEV_MODE="false"

# Enable Debug Logging
ENABLE_DEBUG_LOGGING="true"

# Enable Profile Logging
ENABLE_PROFILE_LOGGING="false"

# Test Database Configuration
TEST_DB_ENABLED="false"